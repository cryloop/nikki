<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Winterscape Generator</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #0a0a12;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Playfair Display', serif;
      overflow: hidden;
    }
    
    h1 {
      color: #e8e4dc;
      font-size: 1.8rem;
      margin-bottom: 1rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      text-shadow: 0 0 20px rgba(200, 220, 255, 0.3);
    }
    
    canvas {
      border-radius: 4px;
      box-shadow: 
        0 0 60px rgba(100, 150, 200, 0.15),
        0 20px 60px rgba(0, 0, 0, 0.5);
    }
    
    .controls {
      display: flex;
      gap: 1rem;
      margin-top: 1.2rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    button {
      background: rgba(200, 215, 235, 0.08);
      border: 1px solid rgba(200, 215, 235, 0.2);
      color: #c8d4e8;
      padding: 0.5rem 1.2rem;
      font-family: inherit;
      font-size: 0.85rem;
      letter-spacing: 0.1em;
      cursor: pointer;
      border-radius: 3px;
      transition: all 0.3s ease;
    }
    
    button:hover {
      background: rgba(200, 215, 235, 0.15);
      border-color: rgba(200, 215, 235, 0.4);
    }
    
    button.active {
      background: rgba(180, 200, 230, 0.2);
      border-color: rgba(200, 230, 255, 0.5);
    }
  </style>
</head>
<body>
  <h1>‚ùÑ Winterscape</h1>
  <canvas id="canvas"></canvas>
  <div class="controls">
    <button onclick="regenerate()">New Landscape</button>
    <button onclick="toggleSnow()" id="snowBtn" class="active">Snow: On</button>
    <button onclick="toggleWind()" id="windBtn" class="active">Wind: On</button>
    <button onclick="toggleMoon()" id="moonBtn" class="active">Moon: On</button>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    // High DPI support
    const dpr = window.devicePixelRatio || 1;
    const W = 900;
    const H = 600;
    canvas.width = W * dpr;
    canvas.height = H * dpr;
    canvas.style.width = W + 'px';
    canvas.style.height = H + 'px';
    ctx.scale(dpr, dpr);
    
    // State
    let snowflakes = [];
    let snowEnabled = true;
    let windEnabled = true;
    let moonEnabled = true;
    let time = 0;
    let mountains = [];
    let trees = [];
    
    // Initialize scene
    function init() {
      generateMountains();
      generateTrees();
      createSnowflakes();
    }
    
    function generateMountains() {
      mountains = [];
      const points = 12;
      const baseY = H * 0.65;
      
      for (let layer = 0; layer < 3; layer++) {
        const layerPoints = [];
        const amplitude = 120 - layer * 30;
        const yOffset = layer * 40;
        const roughness = 0.5 + layer * 0.15;
        
        for (let i = 0; i <= points; i++) {
          const x = (W / points) * i;
          let y = baseY + yOffset - Math.sin(i * 0.8 + layer) * amplitude * 0.5;
          y += (Math.random() - 0.5) * amplitude * roughness;
          
          // Add peaks
          if (i > 1 && i < points && Math.random() > 0.6) {
            y -= Math.random() * amplitude * 0.4;
          }
          
          layerPoints.push({ x, y });
        }
        mountains.push({ points: layerPoints, layer });
      }
    }
    
    function generateTrees() {
      trees = [];
      const count = 25 + Math.floor(Math.random() * 15);
      
      for (let i = 0; i < count; i++) {
        const x = Math.random() * W;
        const mountainY = getMountainY(x);
        
        if (mountainY < H - 50) {
          trees.push({
            x,
            y: mountainY + Math.random() * 20,
            height: 15 + Math.random() * 35,
            width: 8 + Math.random() * 12,
            snow: Math.random() > 0.3
          });
        }
      }
    }
    
    function getMountainY(x) {
      // Find Y at given X using middle mountain layer
      const mid = mountains[1];
      if (!mid || mid.points.length < 2) return H;
      
      for (let i = 0; i < mid.points.length - 1; i++) {
        const p1 = mid.points[i];
        const p2 = mid.points[i + 1];
        if (x >= p1.x && x <= p2.x) {
          const t = (x - p1.x) / (p2.x - p1.x);
          return p1.y + (p2.y - p1.y) * t;
        }
      }
      return mid.points[mid.points.length - 1].y;
    }
    
    function createSnowflakes() {
      snowflakes = [];
      const count = 200;
      
      for (let i = 0; i < count; i++) {
        snowflakes.push({
          x: Math.random() * W,
          y: Math.random() * H,
          r: 1 + Math.random() * 3,
          speed: 0.5 + Math.random() * 1.5,
          drift: Math.random() * Math.PI * 2,
          driftSpeed: 0.01 + Math.random() * 0.02
        });
      }
    }
    
    function drawSky() {
      // Gradient sky - deep blue to pale horizon
      const gradient = ctx.createLinearGradient(0, 0, 0, H);
      gradient.addColorStop(0, '#0a0a1a');
      gradient.addColorStop(0.4, '#1a1a3a');
      gradient.addColorStop(0.7, '#2a2a4a');
      gradient.addColorStop(1, '#4a4a5a');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, W, H);
      
      // Stars
      ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
      for (let i = 0; i < 80; i++) {
        const x = (i * 137.5) % W;
        const y = (i * 73.3) % (H * 0.5);
        const size = (i % 3) * 0.5 + 0.5;
        const twinkle = Math.sin(time * 0.003 + i) * 0.3 + 0.7;
        ctx.globalAlpha = twinkle * 0.6;
        ctx.beginPath();
        ctx.arc(x, y, size, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }
    
    function drawMoon() {
      if (!moonEnabled) return;
      
      const mx = W * 0.8;
      const my = H * 0.15;
      const mr = 35;
      
      // Glow
      const glow = ctx.createRadialGradient(mx, my, mr, mx, my, mr * 4);
      glow.addColorStop(0, 'rgba(255, 255, 230, 0.4)');
      glow.addColorStop(0.3, 'rgba(255, 255, 220, 0.15)');
      glow.addColorStop(1, 'rgba(255, 255, 220, 0)');
      ctx.fillStyle = glow;
      ctx.beginPath();
      ctx.arc(mx, my, mr * 4, 0, Math.PI * 2);
      ctx.fill();
      
      // Moon
      ctx.fillStyle = '#f5f5e8';
      ctx.beginPath();
      ctx.arc(mx, my, mr, 0, Math.PI * 2);
      ctx.fill();
      
      // Craters
      ctx.fillStyle = 'rgba(200, 200, 180, 0.3)';
      ctx.beginPath();
      ctx.arc(mx - 10, my - 5, 8, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(mx + 12, my + 8, 5, 0, Math.PI * 2);
      ctx.fill();
      ctx.beginPath();
      ctx.arc(mx - 5, my + 15, 4, 0, Math.PI * 2);
      ctx.fill();
    }
    
    function drawMountains() {
      mountains.forEach((layer, idx) => {
        const colors = [
          ['#1a1a2a', '#2a2a3a'],
          ['#252535', '#353545'],
          ['#303040', '#404050']
        ];
        
        const [baseColor, highlightColor] = colors[idx] || colors[2];
        
        // Layer shadow
        ctx.fillStyle = baseColor;
        ctx.beginPath();
        ctx.moveTo(0, H);
        
        layer.points.forEach((p, i) => {
          if (i === 0) ctx.lineTo(p.x, p.y);
          else ctx.lineTo(p.x, p.y);
        });
        
        ctx.lineTo(W, H);
        ctx.closePath();
        ctx.fill();
        
        // Snow caps on front mountains
        if (idx === 1) {
          ctx.strokeStyle = 'rgba(200, 210, 220, 0.15)';
          ctx.lineWidth = 1;
          layer.points.forEach((p, i) => {
            if (i > 0) {
              const prev = layer.points[i - 1];
              const slope = (p.y - prev.y) / (p.x - prev.x);
              if (slope < -0.3) {
                ctx.beginPath();
                ctx.moveTo(prev.x, prev.y);
                ctx.lineTo(p.x, p.y);
                ctx.stroke();
              }
            }
          });
        }
      });
    }
    
    function drawTrees() {
      trees.forEach(tree => {
        // Trunk
        ctx.fillStyle = '#1a1510';
        ctx.fillRect(tree.x - 2, tree.y - tree.height * 0.3, 4, tree.height * 0.4);
        
        // Foliage - triangular pine
        ctx.fillStyle = '#0a1a10';
        ctx.beginPath();
        ctx.moveTo(tree.x, tree.y - tree.height);
        ctx.lineTo(tree.x - tree.width / 2, tree.y);
        ctx.lineTo(tree.x + tree.width / 2, tree.y);
        ctx.closePath();
        ctx.fill();
        
        // Snow on tree
        if (tree.snow) {
          ctx.fillStyle = 'rgba(220, 225, 235, 0.7)';
          ctx.beginPath();
          ctx.moveTo(tree.x, tree.y - tree.height);
          ctx.lineTo(tree.x - tree.width * 0.3, tree.y - tree.height * 0.6);
          ctx.lineTo(tree.x + tree.width * 0.3, tree.y - tree.height * 0.6);
          ctx.closePath();
          ctx.fill();
        }
      });
    }
    
    function drawGround() {
      // Snowy ground
      const groundY = H * 0.82;
      const gradient = ctx.createLinearGradient(0, groundY, 0, H);
      gradient.addColorStop(0, '#404050');
      gradient.addColorStop(1, '#505060');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, groundY, W, H - groundY);
      
      // Ground sparkle
      ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
      for (let i = 0; i < 30; i++) {
        const x = (i * 73) % W;
        const y = groundY + 10 + (i * 17) % (H - groundY - 20);
        const sparkle = Math.sin(time * 0.005 + i * 0.5) * 0.5 + 0.5;
        ctx.globalAlpha = sparkle * 0.4;
        ctx.beginPath();
        ctx.arc(x, y, 1, 0, Math.PI * 2);
        ctx.fill();
      }
      ctx.globalAlpha = 1;
    }
    
    function drawSnow() {
      if (!snowEnabled) return;
      
      ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
      
      snowflakes.forEach(flake => {
        const windOffset = windEnabled ? Math.sin(flake.drift) * 20 : 0;
        
        ctx.globalAlpha = 0.5 + flake.r / 4;
        ctx.beginPath();
        ctx.arc(flake.x + windOffset, flake.y, flake.r, 0, Math.PI * 2);
        ctx.fill();
      });
      
      ctx.globalAlpha = 1;
    }
    
    function updateSnow() {
      if (!snowEnabled) return;
      
      snowflakes.forEach(flake => {
        flake.y += flake.speed;
        flake.drift += flake.driftSpeed;
        
        if (windEnabled) {
          flake.x += Math.sin(flake.drift) * 0.5;
        }
        
        // Reset when off screen
        if (flake.y > H) {
          flake.y = -5;
          flake.x = Math.random() * W;
        }
        if (flake.x < -20) flake.x = W + 20;
        if (flake.x > W + 20) flake.x = -20;
      });
    }
    
    function draw() {
      ctx.clearRect(0, 0, W, H);
      
      drawSky();
      drawMoon();
      drawMountains();
      drawGround();
      drawTrees();
      drawSnow();
      
      updateSnow();
      time++;
      
      requestAnimationFrame(draw);
    }
    
    // Controls
    function regenerate() {
      init();
    }
    
    function toggleSnow() {
      snowEnabled = !snowEnabled;
      document.getElementById('snowBtn').textContent = 'Snow: ' + (snowEnabled ? 'On' : 'Off');
      document.getElementById('snowBtn').classList.toggle('active', snowEnabled);
    }
    
    function toggleWind() {
      windEnabled = !windEnabled;
      document.getElementById('windBtn').textContent = 'Wind: ' + (windEnabled ? 'On' : 'Off');
      document.getElementById('windBtn').classList.toggle('active', windEnabled);
    }
    
    function toggleMoon() {
      moonEnabled = !moonEnabled;
      document.getElementById('moonBtn').textContent = 'Moon: ' + (moonEnabled ? 'On' : 'Off');
      document.getElementById('moonBtn').classList.toggle('active', moonEnabled);
    }
    
    // Start
    init();
    draw();
  </script>
</body>
</html>
